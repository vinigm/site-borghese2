<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Encontre o im√≥vel dos seus sonhos. Apartamentos e casas para venda e aluguel com as melhores condi√ß√µes.">
  <title>Borghese - Im√≥veis Dispon√≠veis</title>
  
  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üè†</text></svg>">
  
  <!-- CSS -->
  <link rel="stylesheet" href="../src/styles/main.css">
</head>
<body class="pagina-imoveis">
  <!--HEADER -->
  <header class="header">
    <div class="header__container">
      <a href="../index.html" class="header__logo">
        <img src="../assets/images/borghese-logo.png" alt="Borghese Assessoria Imobili√°ria" class="header__logo-img">
      </a>

      <nav class="header__nav">
        <ul class="nav__lista">
          <li class="nav__item">
            <a href="../index.html" class="nav__link">In√≠cio</a>
          </li>
          <li class="nav__item">
            <a href="imoveis.html" class="nav__link ativo">Im√≥veis</a>
          </li>
          <li class="nav__item">
            <a href="empreendimentos.html" class="nav__link">Empreendimentos</a>
          </li>
          <li class="nav__item">
            <a href="sobre.html" class="nav__link">Sobre</a>
          </li>
          <li class="nav__item">
            <a href="contato.html" class="nav__link">Contato</a>
          </li>
        </ul>
      </nav>

      <div class="header__cta oculto-mobile">
        <a 
          href="https://wa.me/5551993016930?text=Ol√°!%20Vim%20do%20site%20e%20gostaria%20de%20mais%20informa√ß√µes." 
          target="_blank" 
          rel="noopener"
          class="botao botao--whatsapp"
          style="margin-right: 0.75rem;"
        >
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
            <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/>
          </svg>
          WhatsApp
        </a>
        <a href="contato.html" class="botao botao--primario">
          Fale Conosco
        </a>
      </div>

      <button class="header__menu-toggle" aria-label="Menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
  </header>

  <!-- BANNER -->
  <section class="banner-pagina">
    <div class="banner-pagina__container">
      <h1 class="banner-pagina__titulo">Nossos Im√≥veis</h1>
      <nav class="banner-pagina__breadcrumb">
        <a href="../index.html">In√≠cio</a>
        <span class="banner-pagina__breadcrumb-separador">‚Üí</span>
        <span>Im√≥veis</span>
      </nav>
    </div>
  </section>

  <!-- CONTAINER PRINCIPAL -->
  <div class="imoveis-container">
    <div class="imoveis-layout">
      <!-- SIDEBAR - FILTROS -->
      <aside class="imoveis-sidebar">
        <div class="filtros">
          <h2 class="filtros__titulo">
            <span>üîç</span>
            Filtrar Im√≥veis
            <button type="button" class="filtros__fechar-mobile visivel-mobile" aria-label="Fechar filtros">
              ‚úï Fechar
            </button>
          </h2>

          <form class="filtros__form" id="form-filtros">
            <!-- Tipo de Transa√ß√£o -->
            <div class="filtros__campo">
              <label class="filtros__label" for="transacao">
                <span>üí∞</span>
                Tipo de Transa√ß√£o
              </label>
              <select class="filtros__select" id="transacao" name="transacao">
                <option value="todos">Todos</option>
                <option value="venda">Venda</option>
                <option value="aluguel">Aluguel</option>
              </select>
            </div>

            <!-- Tipo de Im√≥vel -->
            <div class="filtros__campo">
              <label class="filtros__label" for="tipo">
                <span>üè†</span>
                Tipo de Im√≥vel
              </label>
              <select class="filtros__select" id="tipo" name="tipo">
                <option value="todos">Todos</option>
                <option value="apartamento">Apartamento</option>
                <option value="casa">Casa</option>
                <option value="terreno">Terreno</option>
                <option value="comercial">Comercial</option>
              </select>
            </div>

            <!-- Empreendimento -->
            <div class="filtros__campo">
              <label class="filtros__label" for="empreendimento">
                <span>üèóÔ∏è</span>
                Empreendimento
              </label>
              <select class="filtros__select" id="empreendimento" name="empreendimento">
                <option value="todos">Todos</option>
                <!-- Op√ß√µes ser√£o carregadas via JavaScript -->
              </select>
            </div>

            <!-- Bairros -->
            <div class="filtros__campo filtros__campo--dropdown">
              <label class="filtros__label">
                <span>üìç</span>
                Bairros
              </label>
              <button 
                type="button" 
                class="filtros__dropdown-toggle" 
                id="bairros-toggle"
                aria-expanded="false"
              >
                <span class="filtros__dropdown-texto">Todos os bairros</span>
                <svg class="filtros__dropdown-icone" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polyline points="6 9 12 15 18 9"></polyline>
                </svg>
              </button>
              <div class="filtros__dropdown-menu" id="bairros-menu">
                <div class="filtros__dropdown-search">
                  <input 
                    type="text" 
                    class="filtros__input" 
                    id="busca-bairro"
                    placeholder="Buscar bairro..."
                  />
                </div>
                <div class="filtros__checkbox-lista" id="lista-bairros">
                  <!-- Bairros de Porto Alegre -->
                  <label class="filtros__checkbox-item">
                    <input type="checkbox" name="bairros" value="Menino Deus" />
                    <span>Menino Deus</span>
                  </label>
                  <label class="filtros__checkbox-item">
                    <input type="checkbox" name="bairros" value="Teres√≥polis" />
                    <span>Teres√≥polis</span>
                  </label>
                  <label class="filtros__checkbox-item">
                    <input type="checkbox" name="bairros" value="Moinhos de Vento" />
                    <span>Moinhos de Vento</span>
                  </label>
                  <label class="filtros__checkbox-item">
                    <input type="checkbox" name="bairros" value="Petr√≥polis" />
                    <span>Petr√≥polis</span>
                  </label>
                  <label class="filtros__checkbox-item">
                    <input type="checkbox" name="bairros" value="Bela Vista" />
                    <span>Bela Vista</span>
                  </label>
                  <label class="filtros__checkbox-item">
                    <input type="checkbox" name="bairros" value="Tr√™s Figueiras" />
                    <span>Tr√™s Figueiras</span>
                  </label>
                  <label class="filtros__checkbox-item">
                    <input type="checkbox" name="bairros" value="Auxiliadora" />
                    <span>Auxiliadora</span>
                  </label>
                  <label class="filtros__checkbox-item">
                    <input type="checkbox" name="bairros" value="Mont Serrat" />
                    <span>Mont Serrat</span>
                  </label>
                  <label class="filtros__checkbox-item">
                    <input type="checkbox" name="bairros" value="Boa Vista" />
                    <span>Boa Vista</span>
                  </label>
                  <label class="filtros__checkbox-item">
                    <input type="checkbox" name="bairros" value="Higien√≥polis" />
                    <span>Higien√≥polis</span>
                  </label>
                  <label class="filtros__checkbox-item">
                    <input type="checkbox" name="bairros" value="Rio Branco" />
                    <span>Rio Branco</span>
                  </label>
                  <label class="filtros__checkbox-item">
                    <input type="checkbox" name="bairros" value="Jardim Bot√¢nico" />
                    <span>Jardim Bot√¢nico</span>
                  </label>
                  <label class="filtros__checkbox-item">
                    <input type="checkbox" name="bairros" value="Ch√°cara das Pedras" />
                    <span>Ch√°cara das Pedras</span>
                  </label>
                  <label class="filtros__checkbox-item">
                    <input type="checkbox" name="bairros" value="Bom Fim" />
                    <span>Bom Fim</span>
                  </label>
                  <label class="filtros__checkbox-item">
                    <input type="checkbox" name="bairros" value="Centro Hist√≥rico" />
                    <span>Centro Hist√≥rico</span>
                  </label>
                  <label class="filtros__checkbox-item">
                    <input type="checkbox" name="bairros" value="Cidade Baixa" />
                    <span>Cidade Baixa</span>
                  </label>
                  <label class="filtros__checkbox-item">
                    <input type="checkbox" name="bairros" value="Praia de Belas" />
                    <span>Praia de Belas</span>
                  </label>
                  <label class="filtros__checkbox-item">
                    <input type="checkbox" name="bairros" value="Cristal" />
                    <span>Cristal</span>
                  </label>
                  <label class="filtros__checkbox-item">
                    <input type="checkbox" name="bairros" value="Ipanema" />
                    <span>Ipanema</span>
                  </label>
                  <label class="filtros__checkbox-item">
                    <input type="checkbox" name="bairros" value="Tristeza" />
                    <span>Tristeza</span>
                  </label>
                  <label class="filtros__checkbox-item">
                    <input type="checkbox" name="bairros" value="Cavalhada" />
                    <span>Cavalhada</span>
                  </label>
                  <label class="filtros__checkbox-item">
                    <input type="checkbox" name="bairros" value="Restinga" />
                    <span>Restinga</span>
                  </label>
                  <label class="filtros__checkbox-item">
                    <input type="checkbox" name="bairros" value="Bel√©m Novo" />
                    <span>Bel√©m Novo</span>
                  </label>
                  <label class="filtros__checkbox-item">
                    <input type="checkbox" name="bairros" value="Lami" />
                    <span>Lami</span>
                  </label>
                </div>
              </div>
            </div>

            <!-- Faixa de Pre√ßo -->
<div class="filtros__campo">
              <label class="filtros__label">
                <span>üíµ</span>
                Faixa de Pre√ßo
              </label>
              <div class="filtros__range filtros__range--vertical">
                <input 
                  type="number" 
                  class="filtros__input" 
                  id="precoMin" 
                  name="precoMin"
                  placeholder="M√≠nimo"
                  min="0"
                  step="10000"
                />
                <span class="filtros__range-separador">at√©</span>
                <input 
                  type="number" 
                  class="filtros__input" 
                  id="precoMax" 
                  name="precoMax"
                  placeholder="M√°ximo"
                  min="0"
                  step="10000"
                />
              </div>
            </div>

            <!-- Quartos -->
            <div class="filtros__campo">
              <label class="filtros__label" for="quartos">
                <span>üõèÔ∏è</span>
                Quartos (m√≠nimo)
              </label>
              <select class="filtros__select" id="quartos" name="quartos">
                <option value="">Qualquer</option>
                <option value="1">1+</option>
                <option value="2">2+</option>
                <option value="3">3+</option>
                <option value="4">4+</option>
              </select>
            </div>

            <!-- Banheiros -->
            <div class="filtros__campo">
              <label class="filtros__label" for="banheiros">
                <span>üöø</span>
                Banheiros (m√≠nimo)
              </label>
              <select class="filtros__select" id="banheiros" name="banheiros">
                <option value="">Qualquer</option>
                <option value="1">1+</option>
                <option value="2">2+</option>
                <option value="3">3+</option>
              </select>
            </div>

            <!-- Vagas -->
            <div class="filtros__campo">
              <label class="filtros__label" for="vagas">
                <span>üöó</span>
                Vagas (m√≠nimo)
              </label>
              <select class="filtros__select" id="vagas" name="vagas">
                <option value="">Qualquer</option>
                <option value="1">1+</option>
                <option value="2">2+</option>
                <option value="3">3+</option>
              </select>
            </div>

            <!-- √Årea M√≠nima -->
            <div class="filtros__campo">
              <label class="filtros__label" for="areaMin">
                <span>üìê</span>
                √Årea M√≠nima (m¬≤)
              </label>
              <input 
                type="number" 
                class="filtros__input" 
                id="areaMin" 
                name="areaMin"
                placeholder="Ex: 50"
                min="0"
              />
            </div>

            <!-- Busca por Texto -->
            <div class="filtros__campo">
              <label class="filtros__label" for="busca">
                <span>üîé</span>
                Buscar por
              </label>
              <input 
                type="text" 
                class="filtros__input" 
                id="busca" 
                name="busca"
                placeholder="Bairro, cidade..."
              />
            </div>

            <!-- Bot√µes -->
            <div class="filtros__acoes">
              <button 
                type="button" 
                class="botao botao--outline filtros__botao-limpar"
                data-acao="limpar-filtros"
                style="flex: 1;"
              >
                üîÑ Limpar Filtros
              </button>
            </div>
          </form>

          <!-- Filtros Ativos -->
          <div class="filtros__ativos" data-filtros-ativos style="display: none;"></div>
        </div>
      </aside>

      <!-- √ÅREA PRINCIPAL -->
      <main class="imoveis-main">
        <!-- Toolbar -->
        <div class="imoveis-toolbar">
          <div class="imoveis-toolbar__info">
            <div class="imoveis-toolbar__botoes-mobile visivel-mobile">
              <button class="botao botao--outline botao--pequeno botao-filtros-mobile visivel-mobile">
                üîç Todos os filtros
              </button>
              <button class="botao botao--outline botao--pequeno botao-limpar-mobile visivel-mobile">
                üîÑ Limpar filtros
              </button>
            </div>
            <div class="imoveis-toolbar__contador" data-contador-imoveis>
              Carregando...
            </div>
          </div>

          <div class="imoveis-toolbar__acoes">
            <div class="imoveis-toolbar__ordenacao">
              <label class="imoveis-toolbar__ordenacao-label" for="ordenacao">
                Ordenar por:
              </label>
              <select 
                class="imoveis-toolbar__ordenacao-select" 
                id="ordenacao"
                name="ordenacao"
              >
                <option value="">Padr√£o</option>
                <option value="preco-asc">Menor Pre√ßo</option>
                <option value="preco-desc">Maior Pre√ßo</option>
                <option value="area-asc">Menor √Årea</option>
                <option value="area-desc">Maior √Årea</option>
                <option value="recentes">Mais Recentes</option>
              </select>
            </div>
          </div>
        </div>

        <div class="filtros-rapidos-mobile visivel-mobile">
          <h3 class="filtros-rapidos-mobile__titulo">Filtros R√°pidos</h3>

          <div class="filtros-rapidos-mobile__campo">
            <label for="filtro-rapido-preco-min">Pre√ßo m√≠nimo</label>
            <input
              type="number"
              id="filtro-rapido-preco-min"
              class="filtros-rapidos-mobile__input"
              placeholder="Ex: 300000"
              min="0"
              step="10000"
            />
          </div>

          <div class="filtros-rapidos-mobile__campo">
            <label for="filtro-rapido-preco-max">Pre√ßo m√°ximo</label>
            <input
              type="number"
              id="filtro-rapido-preco-max"
              class="filtros-rapidos-mobile__input"
              placeholder="Ex: 800000"
              min="0"
              step="10000"
            />
          </div>

          <div class="filtros-rapidos-mobile__campo">
            <label for="filtro-rapido-quartos">Quartos</label>
            <select id="filtro-rapido-quartos" class="filtros-rapidos-mobile__input">
              <option value="">Qualquer</option>
              <option value="1">1+</option>
              <option value="2">2+</option>
              <option value="3">3+</option>
              <option value="4">4+</option>
            </select>
          </div>

          <div class="filtros-rapidos-mobile__campo">
            <label>Bairro (m√∫ltiplo)</label>
            <div id="filtro-rapido-bairros-lista" class="filtros-rapidos-mobile__bairros-lista"></div>
          </div>
        </div>

        <!-- Grid de Im√≥veis -->
        <div class="grid-imoveis" id="lista-imoveis">
          <!-- Im√≥veis ser√£o carregados via JavaScript -->
          <div class="loading-container">
            <div class="loading-spinner loading-spinner--large"></div>
            <p style="margin-top: 1rem;">Carregando im√≥veis...</p>
          </div>
        </div>
      </main>
    </div>
  </div>

  <!-- FOOTER -->
  <footer class="footer">
    <div class="footer__container">
      <div class="footer__conteudo">
        <div class="footer__secao footer__sobre">
          <p>
            A Borghese √© sua parceira ideal na busca pelo im√≥vel dos sonhos.
          </p>
          <div class="footer__redes-sociais">
            <a href="https://www.instagram.com/borgheseimoveis" target="_blank" rel="noopener" class="footer__rede-social footer__rede-social--instagram" aria-label="Instagram Borghese Im√≥veis">
              <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                <rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect>
                <path d="M16 11.37a4 4 0 1 1-2.63-2.63A4 4 0 0 1 16 11.37z"></path>
                <line x1="17.5" y1="6.5" x2="17.51" y2="6.5"></line>
              </svg>
              Instagram
            </a>
          </div>
        </div>

        <div class="footer__secao">
          <h3>Links R√°pidos</h3>
          <nav class="footer__links-lista">
            <a href="../index.html">In√≠cio</a>
            <a href="imoveis.html">Im√≥veis</a>
            <a href="sobre.html">Sobre N√≥s</a>
            <a href="contato.html">Contato</a>
          </nav>
        </div>

        <div class="footer__secao">
          <h3>Contato</h3>
          <div class="footer__contato-item">
            <span>üìç</span>
            <p>Rua Almirante Gon√ßalves, 214 - Porto Alegre/RS</p>
          </div>
          <div class="footer__contato-item">
            <span>üìû</span>
            <p><a href="tel:+5551993016930">(51) 993016930</a></p>
          </div>
          <div class="footer__contato-item">
            <span>üìß</span>
            <p><a href="mailto:contato@borghese.com.br">contato@borghese.com.br</a></p>
          </div>
        </div>
      </div>

      <div class="footer__bottom">
        <div class="footer__copyright">
          ¬© 2026 Borghese Assessoria Imobili√°ria. Todos os direitos reservados.
        </div>
        <nav class="footer__bottom-links">
          <a href="#">Pol√≠tica de Privacidade</a>
          <a href="#">Termos de Uso</a>
        </nav>
      </div>
    </div>
  </footer>

  <!-- JavaScript -->
  <script type="module">
    import sistemaFiltros from '../src/scripts/components/sistema-filtros.js';
    import carregadorDados from '../src/scripts/utils/carregador-dados.js';

    const urlParams = new URLSearchParams(window.location.search);
    const resetFiltros = urlParams.get('reset');
    if (resetFiltros === '1') {
      localStorage.removeItem('filtrosImoveis');
      const formReset = document.getElementById('form-filtros');
      if (formReset) formReset.reset();
    }

    // Carrega empreendimentos no select
    async function carregarEmpreendimentosSelect() {
      try {
        const empreendimentos = await carregadorDados.carregarEmpreendimentos();
        const select = document.getElementById('empreendimento');
        
        if (select && empreendimentos.length > 0) {
          empreendimentos
            .filter(emp => emp.disponivel)
            .forEach(emp => {
              const option = document.createElement('option');
              option.value = emp.nome;
              option.textContent = emp.nome;
              select.appendChild(option);
            });
        }
      } catch (erro) {
        console.error('Erro ao carregar empreendimentos:', erro);
      }
    }

    // Inicializa sistema de filtros
    carregarEmpreendimentosSelect().then(() => {
      // Controle do dropdown de bairros
      const bairrosToggle = document.getElementById('bairros-toggle');
      const bairrosMenu = document.getElementById('bairros-menu');
      const buscaBairro = document.getElementById('busca-bairro');
      const listaBairros = document.getElementById('lista-bairros');
      const checkboxesBairros = document.querySelectorAll('input[name="bairros"]');

      // Toggle do dropdown
      if (bairrosToggle && bairrosMenu) {
        bairrosToggle.addEventListener('click', (e) => {
          e.stopPropagation();
          const isAberto = bairrosMenu.classList.contains('ativo');
          bairrosMenu.classList.toggle('ativo');
          bairrosToggle.setAttribute('aria-expanded', !isAberto);
        });

        // Fecha ao clicar fora
        document.addEventListener('click', (e) => {
          if (!bairrosToggle.contains(e.target) && !bairrosMenu.contains(e.target)) {
            bairrosMenu.classList.remove('ativo');
            bairrosToggle.setAttribute('aria-expanded', 'false');
          }
        });

        // Impede que cliques dentro do menu o fechem
        bairrosMenu.addEventListener('click', (e) => {
          e.stopPropagation();
        });
      }

      // Busca de bairros
      if (buscaBairro && listaBairros) {
        buscaBairro.addEventListener('input', (e) => {
          const termo = e.target.value.toLowerCase();
          const items = listaBairros.querySelectorAll('.filtros__checkbox-item');
          
          items.forEach(item => {
            const texto = item.textContent.toLowerCase();
            if (texto.includes(termo)) {
              item.style.display = 'flex';
            } else {
              item.style.display = 'none';
            }
          });
        });
      }

      // Atualiza texto do bot√£o quando checkboxes mudam
      function atualizarTextoBairros() {
        const selecionados = Array.from(checkboxesBairros)
          .filter(cb => cb.checked)
          .map(cb => cb.value);
        
        const textoEl = bairrosToggle.querySelector('.filtros__dropdown-texto');
        
        if (selecionados.length === 0) {
          textoEl.textContent = 'Todos os bairros';
        } else if (selecionados.length === 1) {
          textoEl.textContent = selecionados[0];
        } else if (selecionados.length === 2) {
          textoEl.textContent = `${selecionados[0]} e mais 1`;
        } else {
          textoEl.textContent = `${selecionados[0]} e mais ${selecionados.length - 1}`;
        }
      }

      // Filtros r√°pidos (mobile)
      const filtroRapidoPrecoMin = document.getElementById('filtro-rapido-preco-min');
      const filtroRapidoPrecoMax = document.getElementById('filtro-rapido-preco-max');
      const filtroRapidoQuartos = document.getElementById('filtro-rapido-quartos');
      const filtroRapidoBairrosLista = document.getElementById('filtro-rapido-bairros-lista');
      const campoPrecoMin = document.getElementById('precoMin');
      const campoPrecoMax = document.getElementById('precoMax');
      const campoQuartos = document.getElementById('quartos');

      function atualizarFiltroRapidoBairros() {
        if (!filtroRapidoBairrosLista) return;

        const bairrosSelecionados = new Set(
          Array.from(checkboxesBairros)
            .filter(cb => cb.checked)
            .map(cb => cb.value)
        );

        filtroRapidoBairrosLista.querySelectorAll('input[type="checkbox"]').forEach(cb => {
          cb.checked = bairrosSelecionados.has(cb.value);
        });
      }

      if (filtroRapidoBairrosLista) {
        const bairrosUnicos = [...new Set(Array.from(checkboxesBairros).map(cb => cb.value))]
          .sort((a, b) => a.localeCompare(b));

        bairrosUnicos.forEach(bairro => {
          const item = document.createElement('label');
          item.className = 'filtros-rapidos-mobile__checkbox-item';
          item.innerHTML = `
            <input type="checkbox" value="${bairro}" />
            <span>${bairro}</span>
          `;
          filtroRapidoBairrosLista.appendChild(item);
        });

        filtroRapidoBairrosLista.addEventListener('change', (event) => {
          const target = event.target;
          if (!(target instanceof HTMLInputElement) || target.type !== 'checkbox') return;

          const selecionadosRapidos = new Set(
            Array.from(filtroRapidoBairrosLista.querySelectorAll('input[type="checkbox"]:checked'))
              .map(cb => cb.value)
          );

          checkboxesBairros.forEach(cb => {
            cb.checked = selecionadosRapidos.has(cb.value);
          });

          atualizarTextoBairros();
          sistemaFiltros.aplicarFiltros();
        });
      }

      if (filtroRapidoPrecoMin && campoPrecoMin) {
        filtroRapidoPrecoMin.value = campoPrecoMin.value || '';
      }

      if (filtroRapidoPrecoMax && campoPrecoMax) {
        filtroRapidoPrecoMax.value = campoPrecoMax.value || '';
      }

      if (filtroRapidoQuartos && campoQuartos) {
        filtroRapidoQuartos.value = campoQuartos.value || '';
      }

      atualizarFiltroRapidoBairros();

      let timeoutFiltrosRapidos;

      if (filtroRapidoPrecoMin && campoPrecoMin) {
        filtroRapidoPrecoMin.addEventListener('input', () => {
          campoPrecoMin.value = filtroRapidoPrecoMin.value;
          clearTimeout(timeoutFiltrosRapidos);
          timeoutFiltrosRapidos = setTimeout(() => {
            sistemaFiltros.aplicarFiltros();
          }, 500);
        });

        campoPrecoMin.addEventListener('input', () => {
          if (filtroRapidoPrecoMin.value !== campoPrecoMin.value) {
            filtroRapidoPrecoMin.value = campoPrecoMin.value;
          }
        });
      }

      if (filtroRapidoPrecoMax && campoPrecoMax) {
        filtroRapidoPrecoMax.addEventListener('input', () => {
          campoPrecoMax.value = filtroRapidoPrecoMax.value;
          clearTimeout(timeoutFiltrosRapidos);
          timeoutFiltrosRapidos = setTimeout(() => {
            sistemaFiltros.aplicarFiltros();
          }, 500);
        });

        campoPrecoMax.addEventListener('input', () => {
          if (filtroRapidoPrecoMax.value !== campoPrecoMax.value) {
            filtroRapidoPrecoMax.value = campoPrecoMax.value;
          }
        });
      }

      if (filtroRapidoQuartos && campoQuartos) {
        filtroRapidoQuartos.addEventListener('change', () => {
          campoQuartos.value = filtroRapidoQuartos.value;
          sistemaFiltros.aplicarFiltros();
        });

        campoQuartos.addEventListener('change', () => {
          if (filtroRapidoQuartos.value !== campoQuartos.value) {
            filtroRapidoQuartos.value = campoQuartos.value;
          }
        });
      }

      checkboxesBairros.forEach(checkbox => {
        checkbox.addEventListener('change', () => {
          atualizarTextoBairros();
          atualizarFiltroRapidoBairros();
          // Aplica filtros automaticamente
          setTimeout(() => sistemaFiltros.aplicarFiltros(), 100);
        });
      });

      sistemaFiltros.inicializar('#form-filtros', '#lista-imoveis');

      // Aplica filtros automaticamente em TODOS os campos
      const todosSelects = document.querySelectorAll('#form-filtros select');
      todosSelects.forEach(select => {
        select.addEventListener('change', () => {
          sistemaFiltros.aplicarFiltros();
        });
      });

      // Inputs num√©ricos aplicam filtros automaticamente com debounce
      const inputsNumero = document.querySelectorAll('#form-filtros input[type="number"]');
      let timeoutNumero;
      inputsNumero.forEach(input => {
        input.addEventListener('input', () => {
          clearTimeout(timeoutNumero);
          timeoutNumero = setTimeout(() => {
            sistemaFiltros.aplicarFiltros();
          }, 800);
        });
      });

      // Campo de busca tamb√©m aplica automaticamente
      const campoBusca = document.querySelector('#form-filtros input[name="busca"]');
      if (campoBusca) {
        let timeoutBusca;
        campoBusca.addEventListener('input', () => {
          clearTimeout(timeoutBusca);
          timeoutBusca = setTimeout(() => {
            sistemaFiltros.aplicarFiltros();
          }, 600);
        });
      }

      // Pega par√¢metros da URL
      const tipo = urlParams.get('tipo');
      const transacao = urlParams.get('transacao');
      const busca = urlParams.get('busca');
      const empreendimento = urlParams.get('empreendimento');

      // Preenche filtros da URL
      if (tipo) document.getElementById('tipo').value = tipo;
      if (transacao) document.getElementById('transacao').value = transacao;
      if (busca) document.getElementById('busca').value = busca;
      if (empreendimento) document.getElementById('empreendimento').value = empreendimento;

      // Se h√° par√¢metros, aplica filtros
      if (tipo || transacao || busca || empreendimento) {
        setTimeout(() => sistemaFiltros.aplicarFiltros(), 100);
      }
    });

    // Ordena√ß√£o
    document.getElementById('ordenacao').addEventListener('change', (e) => {
      const form = document.getElementById('form-filtros');
      const ordenacaoInput = form.querySelector('[name="ordenacao"]');
      if (ordenacaoInput) {
        ordenacaoInput.value = e.target.value;
      } else {
        const input = document.createElement('input');
        input.type = 'hidden';
        input.name = 'ordenacao';
        input.value = e.target.value;
        form.appendChild(input);
      }
      sistemaFiltros.aplicarFiltros();
    });

    // Menu mobile filtros
    const btnFiltrosMobile = document.querySelector('.botao-filtros-mobile');
    const btnLimparMobile = document.querySelector('.botao-limpar-mobile');
    const sidebar = document.querySelector('.imoveis-sidebar');
    const btnFecharFiltros = document.querySelector('.filtros__fechar-mobile');
    
    if (btnFiltrosMobile && sidebar) {
      btnFiltrosMobile.addEventListener('click', () => {
        sidebar.classList.toggle('aberto');
      });

      if (btnFecharFiltros) {
        btnFecharFiltros.addEventListener('click', () => {
          sidebar.classList.remove('aberto');
        });
      }

      // Fecha ao clicar fora em dispositivos m√≥veis
      document.addEventListener('click', (e) => {
        if (window.innerWidth <= 1024 && 
            !sidebar.contains(e.target) && 
            !btnFiltrosMobile.contains(e.target) &&
            sidebar.classList.contains('aberto')) {
          sidebar.classList.remove('aberto');
        }
      });
    }

    // Bot√£o limpar filtros mobile
    if (btnLimparMobile) {
      btnLimparMobile.addEventListener('click', () => {
        // Limpa filtros r√°pidos
        const filtroPrecoMin = document.getElementById('filtro-rapido-preco-min');
        const filtroPrecoMax = document.getElementById('filtro-rapido-preco-max');
        const filtroQuartos = document.getElementById('filtro-rapido-quartos');
        const filtroBairros = document.getElementById('filtro-rapido-bairros');
        
        if (filtroPrecoMin) filtroPrecoMin.value = '';
        if (filtroPrecoMax) filtroPrecoMax.value = '';
        if (filtroQuartos) filtroQuartos.value = '';
        if (filtroBairros) filtroBairros.value = '';
        
        // Limpa formul√°rio principal
        const form = document.getElementById('form-filtros');
        if (form) {
          form.reset();
          
          // Desmarca todos os checkboxes de bairro
          const checkboxesBairros = form.querySelectorAll('input[name="bairros"]');
          checkboxesBairros.forEach(checkbox => {
            checkbox.checked = false;
          });
          
          // Atualiza o texto do resumo de bairros
          const resumoBairros = document.getElementById('resumo-bairros');
          if (resumoBairros) {
            resumoBairros.textContent = 'Todos os bairros';
          }
        }
        
        // Reaplica filtros (mostrar√° todos os im√≥veis)
        sistemaFiltros.aplicarFiltros();
      });
    }
  </script>
  <script type="module" src="../src/scripts/main.js"></script>
</body>
</html>
